
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../utils/">
      
      
        <link rel="next" href="../testing/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Plotting - ez_zarr</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#helpful-functions-for-plotting-and-working-with-image-arrays" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ez_zarr" class="md-header__button md-logo" aria-label="ez_zarr" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ez_zarr
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Plotting
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ez_zarr" class="md-nav__button md-logo" aria-label="ez_zarr" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ez_zarr
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ome_zarr/" class="md-nav__link">
        OME-Zarr classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hcs_wrappers/" class="md-nav__link">
        Legacy classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Utilities
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Plotting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Plotting
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting" class="md-nav__link">
    plotting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.convert_to_rgb" class="md-nav__link">
    convert_to_rgb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.get_shuffled_cmap" class="md-nav__link">
    get_shuffled_cmap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.pad_image" class="md-nav__link">
    pad_image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.plot_image" class="md-nav__link">
    plot_image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.zproject" class="md-nav__link">
    zproject
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        Unit tests
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started_Image/" class="md-nav__link">
        Working with individual images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started_hcs_wrappers/" class="md-nav__link">
        Working with HCS plates (legacy classes)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting" class="md-nav__link">
    plotting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.convert_to_rgb" class="md-nav__link">
    convert_to_rgb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.get_shuffled_cmap" class="md-nav__link">
    get_shuffled_cmap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.pad_image" class="md-nav__link">
    pad_image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.plot_image" class="md-nav__link">
    plot_image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.ez_zarr.plotting.zproject" class="md-nav__link">
    zproject
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="helpful-functions-for-plotting-and-working-with-image-arrays">Helpful functions for plotting and working with image arrays</h1>


<div class="doc doc-object doc-module">



<a id="src.ez_zarr.plotting"></a>
  <div class="doc doc-contents first">
  
      <p>Helpful functions for plotting and working with image arrays.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="src.ez_zarr.plotting.convert_to_rgb" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">convert_to_rgb</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">channel_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">channel_ranges</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Convert a (channels, y, x) array to an RGB array of shape (y, x, 3).</p>
<p>This function will return a copy of <code>im</code> in order not to affect the input.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>im</code></td>
          <td>
                <code><span title="dask.array">array</span> or <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input image of shape (channels, y, x).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>channel_colors</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list with python color strings (e.g. 'red')
corresponding with the color for each channel in <code>im</code>.</p>
            </div>
          </td>
          <td>
                <code>[&#39;white&#39;]</code>
          </td>
        </tr>
        <tr>
          <td><code>channel_ranges</code></td>
          <td>
                <code>list[list[float]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of 2-element lists (e.g. [0.01, 0.99])
giving the value ranges that should be mapped to colors for each
channel. If the given numerical values are less or equal to 1.0,
they are interpreted as quantiles and the corresponding intensity
values are calculated on the channel non-zero values, otherwise they
are directly used as intensities. Values outside of this range will
be clipped.</p>
            </div>
          </td>
          <td>
                <code>[[0.01, 0.99]]</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to print out information messages.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An RGB image of shape (y, x, 3), where the third axis corresponds to
red, green and blue channels. The image is suitable for plotting with
<code>matplotlib.pyplot.imshow</code> and oriented such that it results in the
same orentiation as when directly plotting a single channel.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p>Convert an image <code>img</code> from (2, y, x) to (y, x, 3), using the
channels as yellow and blue intensities:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">img_rgb</span> <span class="o">=</span> <span class="n">convert_to_rgb</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">])</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/ez_zarr/plotting.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="k">def</span> <span class="nf">convert_to_rgb</span><span class="p">(</span><span class="n">im</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                   <span class="n">channel_colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                   <span class="n">channel_ranges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]],</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                   <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    Convert a (channels, y, x) array to an RGB array of shape (y, x, 3).</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    This function will return a copy of `im` in order not to affect the input.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        im (dask.array or numpy.ndarray): Input image of shape (channels, y, x).</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        channel_colors (list[str]): A list with python color strings (e.g. &#39;red&#39;)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            corresponding with the color for each channel in `im`.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        channel_ranges (list[list[float]]): A list of 2-element lists (e.g. [0.01, 0.99])</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            giving the value ranges that should be mapped to colors for each</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            channel. If the given numerical values are less or equal to 1.0,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            they are interpreted as quantiles and the corresponding intensity</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            values are calculated on the channel non-zero values, otherwise they</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            are directly used as intensities. Values outside of this range will</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            be clipped.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        verbose (bool): Whether to print out information messages.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        An RGB image of shape (y, x, 3), where the third axis corresponds to</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            red, green and blue channels. The image is suitable for plotting with</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            `matplotlib.pyplot.imshow` and oriented such that it results in the</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            same orentiation as when directly plotting a single channel.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        Convert an image `img` from (2, y, x) to (y, x, 3), using the</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        channels as yellow and blue intensities:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; img_rgb = convert_to_rgb(img, [&#39;yellow&#39;, &#39;blue&#39;])   </span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="c1"># digest arguments</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;`im` has shape </span><span class="si">{</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> but must have three dimensions&quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel_colors</span><span class="p">)</span> <span class="o">==</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="sa">f</span><span class="s2">&quot;`channel_colors` must be of the same length as the first axis in `im` (</span><span class="si">{</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel_ranges</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel_colors</span><span class="p">),</span> <span class="p">(</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="sa">f</span><span class="s2">&quot;`channel_ranges` must be of the same length as `channel_colors` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">channel_colors</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="c1"># make a copy of the input argument</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">Array</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="n">im</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="c1"># clip and normalize each channel according to the channel_ranges (im: (ch,y,x))</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">ranges_used</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">channel_ranges</span><span class="p">)):</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">channel_ranges</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="c1"># ranges are given as quantiles -&gt; calculate corresponding intensities</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="n">nonzero</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">nonzero</span><span class="p">):</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">im</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">nonzero</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="n">channel_ranges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">overwrite_input</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="n">rng</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interpreting ranges for channel </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> as quantiles, corresponding to absolute intensities </span><span class="si">{</span><span class="n">rng</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">rng</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="n">rng</span> <span class="o">=</span> <span class="n">channel_ranges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">ranges_used</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">im</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">im</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rng</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rng</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">im</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">im</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">rng</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">rng</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rng</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="c1"># convert the color strings to RGB values</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">rgb_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mcolors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channel_colors</span><span class="p">])</span>    
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="c1"># multiply channels with channel_colors and create weighted sum to (y,x,3)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">rgb_im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;cyx,cr-&gt;yxr&#39;</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">rgb_colors</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="c1"># clip to [0,1], map to [0, 255] and convert to uint8 type</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="n">rgb_im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rgb_im</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">rgb_im</span> <span class="o">=</span> <span class="p">(</span><span class="n">rgb_im</span> <span class="o">*</span> <span class="mf">255.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="k">return</span> <span class="n">rgb_im</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="src.ez_zarr.plotting.get_shuffled_cmap" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_shuffled_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Create shuffled color map.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cmap_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the color map (passed to <code>cmap</code> argument
of matplotlib.colormaps.get_cmap).</p>
            </div>
          </td>
          <td>
                <code>&#39;hsv&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Used to seed the random number generator with
numpy.random.seed.</p>
            </div>
          </td>
          <td>
                <code>42</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p>Obtain a matplotlib.colors.ListedColormap with randomized color ordering:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">get_shuffled_cmap</span><span class="p">()</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/ez_zarr/plotting.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="k">def</span> <span class="nf">get_shuffled_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    Create shuffled color map.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        cmap_name (str): The name of the color map (passed to `cmap` argument</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            of matplotlib.colormaps.get_cmap).</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        seed (int): Used to seed the random number generator with</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">            numpy.random.seed.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        Obtain a matplotlib.colors.ListedColormap with randomized color ordering:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        &gt;&gt;&gt; cm = plotting.get_shuffled_cmap()</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">all_colors</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">all_colors</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">shuffled_cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">all_colors</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">return</span> <span class="n">shuffled_cmap</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="src.ez_zarr.plotting.pad_image" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">pad_image</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">output_shape</span><span class="p">,</span> <span class="n">constant_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Pad an image by adding pixels of <code>constant_value</code> symmetrically around it
to make it shape <code>output_shape</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>im</code></td>
          <td>
                <code><span title="dask.array">array</span> or <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input image.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_shape</code></td>
          <td>
                <code>tuple[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Desired output shape after padding (must be greater
or equal to im.shape).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>constant_value</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value for added pixels.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray with padded image of shape <code>output_shape</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p>Make the image <code>im</code> (100, 100) in shape:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pad_image</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/ez_zarr/plotting.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="k">def</span> <span class="nf">pad_image</span><span class="p">(</span><span class="n">im</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>              <span class="n">output_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>              <span class="n">constant_value</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    Pad an image by adding pixels of `constant_value` symmetrically around it</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    to make it shape `output_shape`.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        im (dask.array or numpy.ndarray): Input image.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        output_shape (tuple[int]): Desired output shape after padding (must be greater</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">            or equal to im.shape).</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        constant_value (int): Value for added pixels.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        np.ndarray with padded image of shape `output_shape`.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        Make the image `im` (100, 100) in shape:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        &gt;&gt;&gt; pad_image(im, (100, 100))</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="c1"># digest arguments</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_shape</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;output_shape </span><span class="si">{</span><span class="n">output_shape</span><span class="si">}</span><span class="s2"> should be of length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">output_shape</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output_shape</span><span class="p">))]),</span> <span class="sa">f</span><span class="s2">&quot;output_shape </span><span class="si">{</span><span class="n">output_shape</span><span class="si">}</span><span class="s2"> must be greater or equal to image shape </span><span class="si">{</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constant_value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="c1"># calculate padding size</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">pad_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">output_shape</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">pad_before</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pad_total</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">pad_after</span> <span class="o">=</span> <span class="n">pad_total</span> <span class="o">-</span> <span class="n">pad_before</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">pad_size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([(</span><span class="n">pad_before</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pad_after</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pad_total</span><span class="p">))])</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="c1"># add padding</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">pad_width</span><span class="o">=</span><span class="n">pad_size</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_values</span><span class="o">=</span><span class="n">constant_value</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="k">return</span> <span class="n">im</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="src.ez_zarr.plotting.plot_image" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_image</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">msk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">msk_alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">show_label_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">restrict_to_label_values</span><span class="o">=</span><span class="p">[],</span> <span class="n">label_text_colour</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">label_fontsize</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">channel_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">channel_ranges</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]],</span> <span class="n">z_projection_method</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">,</span> <span class="n">pad_to_yx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pad_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">image_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis_style</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">spacing_yx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="n">scalebar_pixel</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scalebar_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">scalebar_position</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span> <span class="n">scalebar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scalebar_fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="n">call_show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig_width_inch</span><span class="o">=</span><span class="mf">24.0</span><span class="p">,</span> <span class="n">fig_height_inch</span><span class="o">=</span><span class="mf">16.0</span><span class="p">,</span> <span class="n">fig_dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">fig_style</span><span class="o">=</span><span class="s1">&#39;dark_background&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Plot an image array, optionally overlaid with a segmentation mask.</p>
<p>Plot an image (provided as an array with shape (ch,z,y,x), (ch,y,x) or (y,x))
by summarizing multiple z planes using <code>z_projection_method</code> (if needed),
mapping channels values (in the range of <code>channel_ranges</code>) to colors
(given by <code>channel_colors</code>), converting it to an RGB array of shape
(x,y,3) and plotting it using <code>matplotlib.pyplot.imshow</code>.
If <code>msk</code> is provided, it is assumed to contain a compatible segmentation
mask and will be plotted transparently (controlled by <code>msk_alpha</code>)
on top of the image.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>im</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array with four (ch,z,y,x), three (ch,y,x)
or two (y,x) dimensions with image intensities.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>msk</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An optional cooresponding mask array with
a shape compatible to <code>im</code> (typically without <code>ch</code> axis).
If given, label values will be mapped to discrete colors
and plotted transparently on top of the image.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>msk_alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A scalar value between 0 (fully transparent)
and 1 (solid) defining the transparency of the mask.</p>
            </div>
          </td>
          <td>
                <code>0.3</code>
          </td>
        </tr>
        <tr>
          <td><code>show_label_values</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to show the label values at
the centroid of each label.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>restrict_to_label_values</code></td>
          <td>
                <code>list or scalar</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A scalar or a (possibly
empty) list of label values. Only has an effect if <code>msk</code> is provided.
In that case, pixels with values not in <code>restrict_to_label_values</code>
will be set to <code>pad_value</code> in <code>img</code> (see below), and to 0 in <code>msk</code>.
If empty, all data within the image is shown without restriction.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>label_text_colour</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The colour of the label text, if
<code>show_label_values</code> is True. Ignored otherwise.</p>
            </div>
          </td>
          <td>
                <code>&#39;white&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>label_fontsize</code></td>
          <td>
                <code>float or str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The font size of the label text, if
<code>show_label_values</code> is True. Ignored otherwise. Values accepted
by <code>matplotlib.axes.Axes.text</code> are supported, such a the size
in points (e.g. <code>12.5</code>) or a relative size (e.g. <code>'xx-large'</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;xx-large&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>channels</code></td>
          <td>
                <code>list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The image channel(s) to be plotted. For example,
to plot the first and third channel of a 4-channel image with
shape (4,1,500,600), you can use <code>channels=[0, 2]</code>. If several
channels are given, they will be mapped to colors using
<code>channel_colors</code>. In the case of a single channel, <code>channel_colors</code>
can also be the name of a supported colormap.</p>
            </div>
          </td>
          <td>
                <code>[0]</code>
          </td>
        </tr>
        <tr>
          <td><code>channel_colors</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list with python color strings
(e.g. 'red') defining the color for each channel in <code>channels</code>.
For example, to map the selected <code>channels=[0, 2]</code> to
cyan and magenta, respectively, you can use
<code>channel_colors=['cyan', 'magenta']</code>. If a single channel is
given (e.g. <code>channels=[0]</code>), this can also be one of the following
colormaps: 'viridis', 'plasma', 'inferno', 'magma', 'cividis'.</p>
            </div>
          </td>
          <td>
                <code>[&#39;white&#39;]</code>
          </td>
        </tr>
        <tr>
          <td><code>channel_ranges</code></td>
          <td>
                <code>list[list[float]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of 2-element lists
(e.g. [0.01, 0.95]) giving the the value ranges that should
be mapped to colors for each channel. If the given numerical
values are less or equal to 1.0, they are interpreted as quantiles
and the corresponding intensity values are calculated on the
channel non-zero values, otherwise they are directly used as
intensities. Values outside of this range will be clipped.</p>
            </div>
          </td>
          <td>
                <code>[[0.01, 0.95]]</code>
          </td>
        </tr>
        <tr>
          <td><code>z_projection_method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Method for combining multiple z planes.
For available methods, see ez_zarr.plotting.zproject
(default: 'maximum').</p>
            </div>
          </td>
          <td>
                <code>&#39;maximum&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>pad_to_yx</code></td>
          <td>
                <code>list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the image or label mask are smaller, pad
them by <code>pad_value</code> to this total y and x size. </p>
            </div>
          </td>
          <td>
                <code>[0, 0]</code>
          </td>
        </tr>
        <tr>
          <td><code>pad_value</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value to use for constant-value image padding.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>image_transform</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A function to transform the image values
before conversion to RGB and plotting. If <code>None</code>, no transform is applied.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>axis_style</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A string scalar defining how to draw the axis. Should
be one of 'none' (no axis, the default), 'pixel' (show pixel labels),
'frame' (show just a frame around the plot without ticks)
or 'micrometer' (show micrometer labels). If <code>axis_style='micrometer'</code>,
<code>spacing_yx</code> is used to convert pixel to micrometer.</p>
            </div>
          </td>
          <td>
                <code>&#39;none&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>spacing_yx</code></td>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spacing of pixels in y and x direction,
in micrometer, used to convert pixels to micrometer when
<code>axis_style='micrometer'</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String to add as a title on top of the image. If <code>None</code>
(the default), no title will be added.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>title_fontsize</code></td>
          <td>
                <code>float or str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Font size of the title. Values accepted
by <code>matplotlib.axes.Axes.text</code> are supported, such a the size
in points (e.g. <code>12.5</code>) or a relative size (e.g. <code>'xx-large'</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;large&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scalebar_pixel</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If non-zero, draw a scalebar of size <code>scalebar_pixel</code>
in the corner of the image defined by <code>scalebar_position</code>.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>scalebar_color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Scalebar color.</p>
            </div>
          </td>
          <td>
                <code>&#39;white&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scalebar_position</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>position of the scale bar, one of 'topleft',
'topright', 'bottomleft' or 'bottomright'</p>
            </div>
          </td>
          <td>
                <code>&#39;bottomright&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scalebar_label</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If not <code>None</code> (default), a string scalar to show
as a label for the scale bar.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>scalebar_fontsize</code></td>
          <td>
                <code>float or str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Font size of the scalebar label. Values
accepted by <code>matplotlib.axes.Axes.text</code> are supported, such a the size
in points (e.g. <code>12.5</code>) or a relative size (e.g. <code>'xx-large'</code>).</p>
            </div>
          </td>
          <td>
                <code>&#39;large&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>call_show</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the call to <code>matplotlib.pyplot.imshow</code> is
embedded between <code>matplotlib.pyplot.figure</code> and
<code>matplotlib.pyplot.show</code>/<code>matplotlib.pyplot.close</code> calls.
This is the default behaviour and typically used when an individual
image should be plotted and displayed. It can be set to <code>False</code>
if multiple images should be plotted and their arrangement
is controlled outside of <code>plotting.plot_image</code>. The parameters
<code>fig_width_inch</code>, <code>fig_height_inch</code> and <code>fig_dpi</code> are ignored
in that case.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>fig_width_inch</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure width (in inches).</p>
            </div>
          </td>
          <td>
                <code>24.0</code>
          </td>
        </tr>
        <tr>
          <td><code>fig_height_inch</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure height (in inches).</p>
            </div>
          </td>
          <td>
                <code>16.0</code>
          </td>
        </tr>
        <tr>
          <td><code>fig_dpi</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure resolution (dots per inch).</p>
            </div>
          </td>
          <td>
                <code>150</code>
          </td>
        </tr>
        <tr>
          <td><code>fig_style</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Style for the figure. Supported are 'brightfield', which
is a special mode for single-channel brightfield microscopic images
(it will automatically set <code>channels=[0]</code>, <code>channel_colors=['white']</code>
<code>z_projection_method='minimum'</code>, <code>pad_value=max_int</code> and <code>fig_style='default'</code>),
where <code>max_int</code> is the maximal value for the dtype of <code>im</code>,
and any other styles that can be passed to <code>matplotlib.pyplot.style.context</code>
(default: 'dark_background')</p>
            </div>
          </td>
          <td>
                <code>&#39;dark_background&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to print out information messages.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p>Plot the first channel of <code>img</code> in gray-scale.</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">channel_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">])</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/ez_zarr/plotting.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">im</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>               <span class="n">msk</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>               <span class="n">msk_alpha</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>               <span class="n">show_label_values</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>               <span class="n">restrict_to_label_values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>               <span class="n">label_text_colour</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>               <span class="n">label_fontsize</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>               <span class="n">channels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>               <span class="n">channel_colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>               <span class="n">channel_ranges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]],</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>               <span class="n">z_projection_method</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>               <span class="n">pad_to_yx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>               <span class="n">pad_value</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>               <span class="n">image_transform</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>               <span class="n">axis_style</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>               <span class="n">spacing_yx</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>               <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>               <span class="n">title_fontsize</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>               <span class="n">scalebar_pixel</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>               <span class="n">scalebar_color</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>               <span class="n">scalebar_position</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;bottomright&#39;</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>               <span class="n">scalebar_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>               <span class="n">scalebar_fontsize</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>               <span class="n">call_show</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>               <span class="n">fig_width_inch</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">24.0</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>               <span class="n">fig_height_inch</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">16.0</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>               <span class="n">fig_dpi</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>               <span class="n">fig_style</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;dark_background&#39;</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>               <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        Plot an image array, optionally overlaid with a segmentation mask.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        Plot an image (provided as an array with shape (ch,z,y,x), (ch,y,x) or (y,x))</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        by summarizing multiple z planes using `z_projection_method` (if needed),</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        mapping channels values (in the range of `channel_ranges`) to colors</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        (given by `channel_colors`), converting it to an RGB array of shape</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        (x,y,3) and plotting it using `matplotlib.pyplot.imshow`.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        If `msk` is provided, it is assumed to contain a compatible segmentation</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        mask and will be plotted transparently (controlled by `msk_alpha`)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        on top of the image.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Parameters:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            im (numpy.ndarray): An array with four (ch,z,y,x), three (ch,y,x)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">                or two (y,x) dimensions with image intensities.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            msk (numpy.ndarray): An optional cooresponding mask array with</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">                a shape compatible to `im` (typically without `ch` axis).</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">                If given, label values will be mapped to discrete colors</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">                and plotted transparently on top of the image.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            msk_alpha (float): A scalar value between 0 (fully transparent)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">                and 1 (solid) defining the transparency of the mask.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            show_label_values (bool): Whether to show the label values at</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">                the centroid of each label.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            restrict_to_label_values (list or scalar): A scalar or a (possibly</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">                empty) list of label values. Only has an effect if `msk` is provided.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">                In that case, pixels with values not in `restrict_to_label_values`</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">                will be set to `pad_value` in `img` (see below), and to 0 in `msk`.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">                If empty, all data within the image is shown without restriction.</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">            label_text_colour (str): The colour of the label text, if</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">                `show_label_values` is True. Ignored otherwise.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            label_fontsize (float or str): The font size of the label text, if</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">                `show_label_values` is True. Ignored otherwise. Values accepted</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">                by `matplotlib.axes.Axes.text` are supported, such a the size</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">                in points (e.g. `12.5`) or a relative size (e.g. `&#39;xx-large&#39;`).</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            channels (list[int]): The image channel(s) to be plotted. For example,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">                to plot the first and third channel of a 4-channel image with</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">                shape (4,1,500,600), you can use `channels=[0, 2]`. If several</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">                channels are given, they will be mapped to colors using</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">                `channel_colors`. In the case of a single channel, `channel_colors`</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">                can also be the name of a supported colormap.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            channel_colors (list[str]): A list with python color strings</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">                (e.g. &#39;red&#39;) defining the color for each channel in `channels`.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">                For example, to map the selected `channels=[0, 2]` to</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">                cyan and magenta, respectively, you can use</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">                `channel_colors=[&#39;cyan&#39;, &#39;magenta&#39;]`. If a single channel is</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">                given (e.g. `channels=[0]`), this can also be one of the following</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">                colormaps: &#39;viridis&#39;, &#39;plasma&#39;, &#39;inferno&#39;, &#39;magma&#39;, &#39;cividis&#39;.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            channel_ranges (list[list[float]]): A list of 2-element lists</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">                (e.g. [0.01, 0.95]) giving the the value ranges that should</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">                be mapped to colors for each channel. If the given numerical</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">                values are less or equal to 1.0, they are interpreted as quantiles</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">                and the corresponding intensity values are calculated on the</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                channel non-zero values, otherwise they are directly used as</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                intensities. Values outside of this range will be clipped.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            z_projection_method (str): Method for combining multiple z planes.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">                For available methods, see ez_zarr.plotting.zproject</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">                (default: &#39;maximum&#39;).</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            pad_to_yx (list[int]): If the image or label mask are smaller, pad</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">                them by `pad_value` to this total y and x size. </span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            pad_value (int): Value to use for constant-value image padding.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            image_transform (Callable): A function to transform the image values</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">                before conversion to RGB and plotting. If `None`, no transform is applied.</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            axis_style (str): A string scalar defining how to draw the axis. Should</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">                be one of &#39;none&#39; (no axis, the default), &#39;pixel&#39; (show pixel labels),</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">                &#39;frame&#39; (show just a frame around the plot without ticks)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">                or &#39;micrometer&#39; (show micrometer labels). If `axis_style=&#39;micrometer&#39;`,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">                `spacing_yx` is used to convert pixel to micrometer.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            spacing_yx (list[float]): The spacing of pixels in y and x direction,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">                in micrometer, used to convert pixels to micrometer when</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">                `axis_style=&#39;micrometer&#39;`.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            title (str): String to add as a title on top of the image. If `None`</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">                (the default), no title will be added.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            title_fontsize (float or str): Font size of the title. Values accepted</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">                by `matplotlib.axes.Axes.text` are supported, such a the size</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">                in points (e.g. `12.5`) or a relative size (e.g. `&#39;xx-large&#39;`).</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            scalebar_pixel (int): If non-zero, draw a scalebar of size `scalebar_pixel`</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">                in the corner of the image defined by `scalebar_position`.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            scalebar_color (str): Scalebar color.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            scalebar_position (str): position of the scale bar, one of &#39;topleft&#39;,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">                &#39;topright&#39;, &#39;bottomleft&#39; or &#39;bottomright&#39;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            scalebar_label (str): If not `None` (default), a string scalar to show</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">                as a label for the scale bar.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            scalebar_fontsize (float or str): Font size of the scalebar label. Values</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">                accepted by `matplotlib.axes.Axes.text` are supported, such a the size</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">                in points (e.g. `12.5`) or a relative size (e.g. `&#39;xx-large&#39;`).</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">            call_show (bool): If `True`, the call to `matplotlib.pyplot.imshow` is</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">                embedded between `matplotlib.pyplot.figure` and</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">                `matplotlib.pyplot.show`/`matplotlib.pyplot.close` calls.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">                This is the default behaviour and typically used when an individual</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">                image should be plotted and displayed. It can be set to `False`</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">                if multiple images should be plotted and their arrangement</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">                is controlled outside of `plotting.plot_image`. The parameters</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">                `fig_width_inch`, `fig_height_inch` and `fig_dpi` are ignored</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">                in that case.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            fig_width_inch (float): Figure width (in inches).</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">            fig_height_inch (float): Figure height (in inches).</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">            fig_dpi (int): Figure resolution (dots per inch).</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            fig_style (str): Style for the figure. Supported are &#39;brightfield&#39;, which</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">                is a special mode for single-channel brightfield microscopic images</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">                (it will automatically set `channels=[0]`, `channel_colors=[&#39;white&#39;]`</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">                `z_projection_method=&#39;minimum&#39;`, `pad_value=max_int` and `fig_style=&#39;default&#39;`),</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">                where `max_int` is the maximal value for the dtype of `im`,</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">                and any other styles that can be passed to `matplotlib.pyplot.style.context`</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">                (default: &#39;dark_background&#39;)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">            verbose (bool): Whether to print out information messages.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            Plot the first channel of `img` in gray-scale.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">            &gt;&gt;&gt; plot_image(img, channels=[0], channel_colors=[&#39;white&#39;])</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="c1"># digest arguments</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="k">assert</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="sa">f</span><span class="s2">&quot;Unsupported image dimension (</span><span class="si">{</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">), &quot;</span><span class="p">,</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="s2">&quot;should be either (ch,z,y,x) or (ch,y,x)&quot;</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="k">assert</span> <span class="n">msk</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">msk</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="sa">f</span><span class="s2">&quot;`msk` dimension (</span><span class="si">{</span><span class="n">msk</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">) is not compatible with `im` &quot;</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="sa">f</span><span class="s2">&quot;dimension, should be (</span><span class="si">{</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">nch</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">ch</span> <span class="o">&lt;=</span> <span class="n">nch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">]),</span> <span class="p">(</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="sa">f</span><span class="s2">&quot;Invalid `channels` parameter, must be less or equal to </span><span class="si">{</span><span class="n">nch</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel_colors</span><span class="p">),</span> <span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="sa">f</span><span class="s2">&quot;`channels` and `channel_colors` must have the same length, &quot;</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="sa">f</span><span class="s2">&quot;but are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">channel_colors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="k">assert</span> <span class="n">axis_style</span> <span class="o">!=</span> <span class="s1">&#39;micrometer&#39;</span> <span class="ow">or</span> <span class="n">spacing_yx</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="s2">&quot;For `axis_style=&#39;micrometer&#39;, the parameter `spacing_yx` needs to be provided.&quot;</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">restrict_to_label_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ScalarType</span><span class="p">):</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="n">restrict_to_label_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">restrict_to_label_values</span><span class="p">]</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">restrict_to_label_values</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="p">(</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="sa">f</span><span class="s2">&quot;`restrict_to_label_values` must be a list of values, but is </span><span class="si">{</span><span class="n">restrict_to_label_values</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="c1"># adjust parameters for brightfield images</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">if</span> <span class="n">fig_style</span> <span class="o">==</span> <span class="s1">&#39;brightfield&#39;</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adjusting parameters for brightfield image&quot;</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">channel_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">]</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="n">pad_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">max</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="n">z_projection_method</span> <span class="o">=</span> <span class="s1">&#39;minimum&#39;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="n">fig_style</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="k">if</span> <span class="n">label_text_colour</span> <span class="o">==</span> <span class="s1">&#39;white&#39;</span><span class="p">:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                <span class="n">label_text_colour</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="c1"># combine z planes if needed</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="c1"># im: (ch,z,y,x) -&gt; (ch,y,x))</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying z-projection (</span><span class="si">{</span><span class="n">z_projection_method</span><span class="si">}</span><span class="s2"> method)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">zproject</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">z_projection_method</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                          <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">msk</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                <span class="c1"># msk: (z,y,x) -&gt; (y,x)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                <span class="n">msk</span> <span class="o">=</span> <span class="n">zproject</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">msk</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">,</span> <span class="c1"># always use &#39;maximum&#39; for labels</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="c1"># restrict to label values if needed</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">restrict_to_label_values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">msk</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Restricting to provided label values&quot;</span><span class="p">)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="n">keep_elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">msk</span><span class="p">,</span> <span class="n">restrict_to_label_values</span><span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">keep_elements</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">pad_value</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="n">msk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">keep_elements</span><span class="p">,</span> <span class="n">msk</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="c1"># pad if necessary</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pad_to_yx</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pad_to_yx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pad_to_yx</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Padding to requested size&quot;</span><span class="p">)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">pad_image</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                           <span class="n">output_shape</span><span class="o">=</span><span class="p">[</span><span class="n">nch</span><span class="p">,</span> <span class="n">pad_to_yx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad_to_yx</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                           <span class="n">constant_value</span><span class="o">=</span><span class="n">pad_value</span><span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">msk</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                <span class="n">msk</span> <span class="o">=</span> <span class="n">pad_image</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">msk</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                                <span class="n">output_shape</span><span class="o">=</span><span class="n">pad_to_yx</span><span class="p">,</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                                <span class="n">constant_value</span><span class="o">=</span><span class="n">pad_value</span><span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="c1"># transform image</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">image_transform</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transforming image values&quot;</span><span class="p">)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">image_transform</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="c1"># convert (ch,y,x) to rgb (y,x,3)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">channel_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                                                        <span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="s1">&#39;cividis&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using colormap </span><span class="si">{</span><span class="n">channel_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="c1"># map to colormap</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>            <span class="n">im_rgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">im</span><span class="p">[</span><span class="n">channels</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="n">cmap</span> <span class="o">=</span> <span class="n">channel_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mapping channel colors to rgb space&quot;</span><span class="p">)</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="c1"># map to rgb</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="n">im_rgb</span> <span class="o">=</span> <span class="n">convert_to_rgb</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">im</span><span class="p">[</span><span class="n">channels</span><span class="p">],</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                                    <span class="n">channel_colors</span><span class="o">=</span><span class="n">channel_colors</span><span class="p">,</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                                    <span class="n">channel_ranges</span><span class="o">=</span><span class="n">channel_ranges</span><span class="p">)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="c1"># define nested function with main plotting code</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="k">def</span> <span class="nf">_do_plot</span><span class="p">():</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im_rgb</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">msk</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">msk</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">msk</span><span class="p">,</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                           <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                           <span class="n">cmap</span><span class="o">=</span><span class="n">get_shuffled_cmap</span><span class="p">(),</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                           <span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">msk_alpha</span><span class="p">),</span> <span class="n">msk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                <span class="k">if</span> <span class="n">show_label_values</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                    <span class="n">skim</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s1">&#39;skimage.measure&#39;</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                    <span class="n">props</span> <span class="o">=</span> <span class="n">skim</span><span class="o">.</span><span class="n">regionprops</span><span class="p">(</span><span class="n">msk</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">)):</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">props</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                                 <span class="n">y</span><span class="o">=</span><span class="n">props</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                                 <span class="n">s</span><span class="o">=</span><span class="n">props</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                                 <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                                 <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                                 <span class="n">color</span><span class="o">=</span><span class="n">label_text_colour</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                                 <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="k">if</span> <span class="n">axis_style</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="k">elif</span> <span class="n">axis_style</span> <span class="o">==</span> <span class="s1">&#39;pixel&#39;</span><span class="p">:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                <span class="k">pass</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="k">elif</span> <span class="n">axis_style</span> <span class="o">==</span> <span class="s1">&#39;frame&#39;</span><span class="p">:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span> <span class="c1"># remove axis ticks</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="k">elif</span> <span class="n">axis_style</span> <span class="o">==</span> <span class="s1">&#39;micrometer&#39;</span><span class="p">:</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span> <span class="c1"># get current axes</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>                <span class="n">yticks</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{0:g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">spacing_yx</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>                <span class="n">xticks</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{0:g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">spacing_yx</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown `axis_style` (</span><span class="si">{</span><span class="n">axis_style</span><span class="si">}</span><span class="s2">), should be one of &#39;none&#39;, &#39;pixel&#39;, &#39;frame&#39; or &#39;micrometer&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="k">if</span> <span class="n">title</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fontsize</span><span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="k">if</span> <span class="n">scalebar_pixel</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>                <span class="n">img_yx</span> <span class="o">=</span> <span class="n">im_rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>                <span class="n">d</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">round</span><span class="p">(</span><span class="n">img_yx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span> <span class="c1"># 5% margin</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                <span class="n">scalebar_height</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">img_yx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.0075</span><span class="p">)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>                <span class="k">if</span> <span class="n">scalebar_position</span> <span class="o">==</span> <span class="s1">&#39;bottomright&#39;</span><span class="p">:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>                    <span class="n">pos_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">img_yx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span> <span class="o">-</span> <span class="n">scalebar_pixel</span><span class="p">,</span> <span class="n">img_yx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>                    <span class="n">pos_text_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scalebar_pixel</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pos_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">scalebar_height</span> <span class="o">-</span> <span class="n">d</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>                    <span class="n">va_text</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="k">elif</span> <span class="n">scalebar_position</span> <span class="o">==</span> <span class="s1">&#39;bottomleft&#39;</span><span class="p">:</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                    <span class="n">pos_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">img_yx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                    <span class="n">pos_text_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scalebar_pixel</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pos_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">scalebar_height</span> <span class="o">-</span> <span class="n">d</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                    <span class="n">va_text</span> <span class="o">=</span> <span class="s1">&#39;bottom&#39;</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="k">elif</span> <span class="n">scalebar_position</span> <span class="o">==</span> <span class="s1">&#39;topleft&#39;</span><span class="p">:</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                    <span class="n">pos_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span> <span class="o">+</span> <span class="n">scalebar_height</span><span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                    <span class="n">pos_text_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scalebar_pixel</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pos_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                    <span class="n">va_text</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                <span class="k">elif</span> <span class="n">scalebar_position</span> <span class="o">==</span> <span class="s1">&#39;topright&#39;</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                    <span class="n">pos_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">img_yx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span> <span class="o">-</span> <span class="n">scalebar_pixel</span><span class="p">,</span> <span class="n">d</span> <span class="o">-</span> <span class="n">scalebar_height</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                    <span class="n">pos_text_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">scalebar_pixel</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pos_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                    <span class="n">va_text</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown scalebar_position (</span><span class="si">{</span><span class="n">scalebar_position</span><span class="si">}</span><span class="s2">), should be one of &#39;bottomright&#39;, &#39;bottomleft&#39;, &#39;topright&#39;, or &#39;topleft&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                <span class="n">rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="n">pos_xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">scalebar_pixel</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                                         <span class="n">height</span><span class="o">=</span><span class="n">scalebar_height</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                                         <span class="n">edgecolor</span><span class="o">=</span><span class="n">scalebar_color</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                                         <span class="n">facecolor</span><span class="o">=</span><span class="n">scalebar_color</span><span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span> <span class="c1"># get current axes</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span> <span class="c1"># add the patch to the axes</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="k">if</span> <span class="n">scalebar_label</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pos_text_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">pos_text_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">scalebar_label</span><span class="p">,</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                             <span class="n">color</span><span class="o">=</span><span class="n">scalebar_color</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="n">va_text</span><span class="p">,</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                             <span class="n">fontsize</span><span class="o">=</span><span class="n">scalebar_fontsize</span><span class="p">)</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="c1"># create the plot</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="k">if</span> <span class="n">call_show</span><span class="p">:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">fig_style</span><span class="p">):</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_width_inch</span><span class="p">,</span> <span class="n">fig_height_inch</span><span class="p">))</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                <span class="n">fig</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="n">fig_dpi</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                <span class="n">_do_plot</span><span class="p">()</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="n">_do_plot</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="src.ez_zarr.plotting.zproject" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">zproject</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">img_bit</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Project a 4D or 3D image along z-axis according to desired projection method.</p>
<p>Helper function to conveniently project multi-dimensional images along z-axis according to desired projection method. </p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>im</code></td>
          <td>
                <code><span title="dask.array">array</span> or <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array to be projected.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>axis</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The axis on which to perform the projection (typically
the z-axis). Unless otherwise specified, it defaults to axis 1 (by convention Fractal 
outputs have shape ch,z,y,x). Note: if masks are projected, Fractal output have usually 
shape z,y,x, so use <code>axis=0</code> in that case.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The projection method of choice. Available options are 
'maximum' (default), 'minimum' (typically used for brightfield images), 'sum', 'average'.</p>
            </div>
          </td>
          <td>
                <code>&#39;maximum&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>keepdims</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the output array keep the same dimensions 
as the input array (<code>True</code>), or should the z-axis been squeezed 
(<code>False</code>, default behaviour of e.g. np.min())</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>img_bit</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Is the image 8- or 16-bit? Relevant for 'sum' 
projection, where clipping might be necessary.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="dask.array.Array">Array</span>, <span title="numpy.ndarray">ndarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input array where the z-axis has been projected according to the method of choice.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p>Project np.array along z-axis:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">zproject</span><span class="p">(</span><span class="n">im</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]],[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]]]),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/ez_zarr/plotting.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="k">def</span> <span class="nf">zproject</span><span class="p">(</span><span class="n">im</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>             <span class="n">axis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>             <span class="n">method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;maximum&#39;</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>             <span class="n">keepdims</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>             <span class="n">img_bit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Project a 4D or 3D image along z-axis according to desired projection method.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Helper function to conveniently project multi-dimensional images along z-axis according to desired projection method. </span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        im (dask.array or np.ndarray): The array to be projected.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        axis (int): The axis on which to perform the projection (typically</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            the z-axis). Unless otherwise specified, it defaults to axis 1 (by convention Fractal </span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            outputs have shape ch,z,y,x). Note: if masks are projected, Fractal output have usually </span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            shape z,y,x, so use `axis=0` in that case.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        method (str): The projection method of choice. Available options are </span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            &#39;maximum&#39; (default), &#39;minimum&#39; (typically used for brightfield images), &#39;sum&#39;, &#39;average&#39;.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        keepdims (bool): Should the output array keep the same dimensions </span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            as the input array (`True`), or should the z-axis been squeezed </span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            (`False`, default behaviour of e.g. np.min())</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        img_bit (int): Is the image 8- or 16-bit? Relevant for &#39;sum&#39; </span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            projection, where clipping might be necessary.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        The input array where the z-axis has been projected according to the method of choice.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        Project np.array along z-axis:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        &gt;&gt;&gt; zproject(im=np.array([[[1,2,4],[1,3,5],[1,6,7]],[[1,2,4],[1,3,5],[1,6,7]]]), method=&#39;maximum&#39;, axis=1)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">methods</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="s1">&#39;sum&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="s1">&#39;average&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="p">}</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown method (</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">), should be one of: &quot;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">methods</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">im</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[</span><span class="n">method</span><span class="p">](</span><span class="n">im</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">)</span> 
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">max_value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">img_bit</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">return</span> <span class="n">im</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>